<!doctype html>
<html>

<head>
	<meta charset="utf-8">
    <!-- Title of the page (not necessarily the lab) - for reference only, not displayed on the page-->
	<title>Debugging a Project</title>
    <!-- CSS template stylesheet must be linked here-->
    <link href="css/renesas_layout_style.css" rel="stylesheet" type="text/css">
    <!-- Javascript based lab templating helper must be placed here-->
    <script type="text/javascript" src="js/lab-templater.js"></script>
</head>

<body>
    <!-- Populate the page header (banner, title & navigation menu)-->
	<script>lab_templater.Generate_header();</script>

	<!-- Begin the main content of the page-->
	<div class="main-content">

		<!-- Page/Section Summary & Description-->
		<summary>6. Debugging a Project</summary>
		<p>Here we will guide you through debugging a project for the RL78.</p>

		<!-- Start adding "details" sections for lab steps-->
		<details open>
			<summary id="6.1 - Launching Debug Session">6.1 - Launching Debug Session</summary>
			<p>First ensure the project you wish to debug is active by clicking on it then select the debug
				icon.<br>
				<b>Important:</b><br>
				If you <b>do not</b> have the RL78/G23 128p FPB hardware, when presented with the "Select
				Configuration" dialog then select <b>HelloWorld Debug</b>.<br>
				If you <b>do</b> have the RL78/G23 128p FPB hardware, when presented with the "Select Configuration"
				dialog then select <b>HelloWorld HardwareDebug</b>.<br>
				e<sup>2</sup>studio will promt you and ask if you would like to switch to the debug perspecive,
				answer in the affirmative i.e. "Switch"as this
				will provide you with all the default tools and views used for debugging an embedded
				application.<br>
				The animation below shows this routine for the simulator, but the steps are the same for hardware
				debugging, with the only caveat being the selected debug configuration.<br>
			</p>
			<img class="modal-thumbnails" src="img/img_lab/launchdebug.gif">
		</details>

		<details>
			<summary id="6.2 - Breakpoint, Run &amp; Stepping">6.2 - Breakpoint, Run &amp; Stepping</summary>
			<p>When the application first runs, it will pause on entry to the main function.<br>
				By double-clicking on the grey bar next to the code of interest we can insert a break point and
				halt execution when the CPU executes that line of code.<br></p>
			<img class="modal-thumbnails" src="img/img_lab/installbreakpoint.gif">

			<p><br>
				Now we can click the Run button, and once we hit this breakpoint we can step through the code
				using the step over or step into buttons.<br></p>
			<img class="modal-thumbnails" src="img/img_lab/runstep.gif">

			<p><br>
				And finally we can use nistruction stepping mode (Instruction Step button) to step through the
				assembly generated from the c code, to more granularly debug the program.<br></p>
			<img class="modal-thumbnails" src="img/img_lab/asmstep.gif">
		</details>

		<details>
			<summary id="6.3 - Expression Window">6.3 - Expression Window</summary>
			<p>>Now we can use something called the expression window, to observe <b>global</b> variables
				while the program is in the halted state,
				so while we step through the code we can observe how variables are changing.<br>
				First open the expression window:<br>
				<b>[Window] &rarr; [Show View] &rarr; [Other...]</b><br>
				Then search for expression and open this view,the view should appear somewhere in
				e<sup>2</sup>studio.<br>
			</p>
			<img class="modal-thumbnails" src="img/img_lab/openexpressions.gif">

			<p>Now add the my_counter variable to the expression window by double-clicking the variable name
				to highlight, then holding the mouse down drag and drop the variable to the expression
				window.<br>
				You will see the my_counter variable appear with its current value (note this can only be
				done while the program is not executing - otherwise there will be no data present for the
				variable).<br></p>
			<img class="modal-thumbnails" src="img/img_lab/addingvariable.gif">
		</details>

		<details>
			<summary id="6.4 - Real-time Refresh">6.4 - Real-time Refresh</summary>
			<p>Now to avoid constantly pausing program execution manually, we trigger
				e<sup>2</sup>studio to periodically halt the CPU, read the memory and start it running
				again with
				a feature call real-time refresh. this refresh's variable states in the expression
				window periodically.
				There is a limitation to the period we can do this of 100ms - that is we cannot go
				quicker than this.<br>
				To enable real-time refresh, first disbale the breakpoint by double-clicking (this will
				allow the CPU to run freely).
				Then in the expression window <b>[Right Click] the my_counter variable &rarr; [Enable
					Real-time Refresh]</b><br>
				Again in the expression window <b>[Right Click] the my_counter variable &rarr;
					[Real-time Refresh] &rarr; [Real-time Refresh Interval]</b><br>
				and in the dialog write 100 (fastest we can sample).<br>
				Finally click the Run button to start the program running and observe the counter change
				value in "real time".<br>
				The animation below shows this process.<br></p>
			<img class="modal-thumbnails" src="img/img_lab/realtimerunning.gif">
			<p><b>Note</b> this feature has a performance impact. Specifically in the case of RL78, the
				CPU must be halted by the debugger before the memory is read, which pauses execution of
				the program momentarily.<br></p>
		</details>

		<!-- Prepare the pages modal images-->
		<script>lab_templater.Prepare_modal();</script>

		<!-- Button for going to the next page-->
		<script>lab_templater.Generate_next_page_button("Finished!");</script>

	</div>
</body>

</html>